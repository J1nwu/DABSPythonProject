{% extends "booking/doctor_base.html" %}
{% block page_title %} — Pending Approvals{% endblock %}

{% block content %}
<h3 class="fw-bold mb-3">Pending Appointment Requests</h3>

<p class="text-muted">
  Review and approve or cancel appointment requests assigned to you.
</p>

<div class="table-responsive">
  <table class="table table-striped align-middle">
    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Patient</th>
        <th>Date</th>
        <th>Time</th>
        <th>Reason</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
    {% for appt in pending_appointments %}
      <tr>
        <td>{{ appt.id }}</td>
        <td>{{ appt.patient.user.get_full_name|default:appt.patient.user.username }}</td>
        <td>{{ appt.date }}</td>
        <td>{{ appt.time }}</td>
        <td>{{ appt.reason|default:"—" }}</td>
        <td>{{ appt.status }}</td>
        <td>
          <form method="post" action="{% url 'doctor_approve_appointment' appt.id %}" class="d-inline">
            {% csrf_token %}
            <button class="btn btn-sm btn-success">Approve</button>
          </form>
          <form method="post" action="{% url 'doctor_cancel_appointment' appt.id %}" class="d-inline ms-1">
            {% csrf_token %}
            <button class="btn btn-sm btn-outline-danger">Cancel</button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="7" class="text-muted">No pending appointment requests.</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}