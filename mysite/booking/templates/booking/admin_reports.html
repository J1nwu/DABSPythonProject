<!-- Appointment history: ALL matching appointments -->
<div class="card shadow-sm border-0">
  <div class="card-body">
    <h5 class="fw-bold mb-3">Appointment History</h5>
    <p class="text-muted small">
      All appointments matching the filters above (no date limit unless you set one).
    </p>
    <div class="table-responsive">
      <table class="table table-striped align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>Appt Code</th>
            <th>Patient</th>
            <th>Doctor</th>
            <th>Department</th>
            <th>Hospital</th>
            <th>Date</th>
            <th>Time</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
        {% for a in appointments %}
          <tr>
            <td>{{ a.id }}</td>
            <td>{{ a.code }}</td>
            <td>{{ a.patient.user.get_full_name|default:a.patient.user.username }}</td>
            <td>Dr. {{ a.doctor.user.get_full_name|default:a.doctor.user.username }}</td>
            <td>{{ a.doctor.specialization }}</td>
            <td>{{ a.doctor.hospital }}</td>
            <td>{{ a.date|date:"M j, Y" }}</td>
            <td>{{ a.time|time:"g:i a" }}</td>
            <td>
              <span class="badge
                {% if a.status == 'Approved' %}bg-success
                {% elif a.status == 'Cancelled' %}bg-danger
                {% elif a.status == 'Pending' %}bg-warning text-dark
                {% else %}bg-secondary{% endif %}">
                {{ a.status }}
              </span>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="9" class="text-muted">No appointments found.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}